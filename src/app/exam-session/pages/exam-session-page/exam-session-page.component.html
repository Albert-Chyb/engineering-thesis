@if (testForm()) {
  <mat-card class="with-spacing-fix">
    <mat-card-header>
      <h1 mat-card-title>Rozwiąż test</h1>
      <p mat-card-subtitle>Nazwa testu: {{ metadata()?.name }}</p>
    </mat-card-header>
    <mat-card-content>
      <form
        class="v-stack"
        id="solved-test-form"
        [formGroup]="safelyGetTestForm()"
        (ngSubmit)="handleFormSubmit()"
      >
        <app-test-taker-name
          [form]="safelyGetTestForm().controls.testTakerName"
        />

        @for (question of test()?.questions; track question.id) {
          @switch (question.type) {
            @case ("single-choice") {
              <app-single-choice-question
                [question]="question"
                [form]="safelyGetAnswersFormGroup(question.id)"
              />
            }
            @case ("multi-choice") {
              <app-multi-choice-question
                [question]="question"
                [form]="safelyGetAnswersFormGroup(question.id)"
              />
            }
            @case ("text-answer") {
              <app-text-answer-question
                [question]="question"
                [form]="safelyGetAnswersFormGroup(question.id)"
              />
            }
          }
        }
      </form>

      <pre>{{ safelyGetTestForm().value | json }}</pre>
    </mat-card-content>

    <mat-card-actions align="end">
      <button
        mat-button
        color="accent"
        type="submit"
        form="solved-test-form"
        [disabled]="safelyGetTestForm().invalid"
      >
        Prześlij rozwiązania
      </button>
    </mat-card-actions>
  </mat-card>
}
